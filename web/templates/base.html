<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}BayRecht — Bayerische Gesetze{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}Bayerische Landesgesetze und Verordnungen — kostenlos und übersichtlich.{% endblock %}">
    {% block canonical %}{% endblock %}
    <meta property="og:title" content="{% block og_title %}BayRecht{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Bayerische Landesgesetze und Verordnungen{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="BayRecht">
    <script src="/static/js/htmx.min.js"></script>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <div class="header-inner">
            <a href="/" class="site-title">Bay<span>Recht</span></a>
            <span class="site-subtitle">Bayerische Gesetze</span>
            <div class="header-actions">
                <button class="search-toggle" onclick="toggleSearch()" aria-label="Suche">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round">
                        <circle cx="7.5" cy="7.5" r="5.5"/>
                        <line x1="11.5" y1="11.5" x2="16" y2="16"/>
                    </svg>
                </button>
                <div class="header-menu">
                <button class="menu-toggle" onclick="document.querySelector('.menu-dropdown').classList.toggle('open')" aria-label="Menü">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round">
                        <line x1="3" y1="5" x2="17" y2="5"/>
                        <line x1="3" y1="10" x2="17" y2="10"/>
                        <line x1="3" y1="15" x2="17" y2="15"/>
                    </svg>
                    <span>Menü</span>
                </button>
                <nav class="menu-dropdown">
                    <a href="/">Gesetze</a>
                </nav>
            </div>
            </div>
        </div>
    </header>

    <div class="search-bar" id="search-bar">
        <div class="search-bar-inner">
            <input
                type="text"
                class="search-input"
                id="search-input"
                name="q"
                placeholder="Gesetz oder Artikel suchen…"
                autocomplete="off"
                hx-get="/suche"
                hx-trigger="keyup changed delay:250ms"
                hx-target="#search-results"
                hx-params="q"
                hx-indicator=".search-spinner"
            >
            <span class="search-spinner"></span>
            <button class="search-close" onclick="toggleSearch()" aria-label="Suche schließen">✕</button>
        </div>
        <div id="search-results" class="search-results"></div>
    </div>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        <div class="footer-inner">
            Bayerische Gesetze &mdash; Keine amtliche Veröffentlichung
            <div>
                <a href="/docs" class="footer-link">API</a>
                <a href="/sitemap.xml" class="footer-link">Sitemap</a>
                <a href="/impressum" class="footer-link">Impressum</a>
            </div>
        </div>
    </footer>
    <script>
        function toggleSearch() {
            const bar = document.getElementById('search-bar');
            const input = document.getElementById('search-input');
            const results = document.getElementById('search-results');
            bar.classList.toggle('open');
            if (bar.classList.contains('open')) {
                input.focus();
            } else {
                input.value = '';
                results.innerHTML = '';
            }
        }

        document.addEventListener('click', function(e) {
            const menu = document.querySelector('.menu-dropdown');
            const toggle = document.querySelector('.menu-toggle');
            if (menu && !menu.contains(e.target) && !toggle.contains(e.target)) {
                menu.classList.remove('open');
            }

            const searchBar = document.getElementById('search-bar');
            const searchToggle = document.querySelector('.search-toggle');
            if (searchBar && searchBar.classList.contains('open')
                && !searchBar.contains(e.target) && !searchToggle.contains(e.target)) {
                toggleSearch();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const searchBar = document.getElementById('search-bar');
                if (searchBar && searchBar.classList.contains('open')) {
                    toggleSearch();
                }
            }
        });
    </script>
</body>
</html>